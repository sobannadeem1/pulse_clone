import"./shreddit-slotter-f16ffef5.js";import"./faceplate-tabpanel-af679008.js";import"./auth-flow-modal-8655c5ee.js";import"./auth-text-input-59fd8ff9.js";import"./auth-flow-sso-buttons-15a06e50.js";import"./shreddit-signup-drawer-936098b7.js";import{a as t,_ as e,n as s,t as i,E as o,O as a,a5 as n,e as r,ay as l}from"./shell-97fd3bd7.js";import{S as h}from"./scroll-blocker-0e59bc75.js";import{O as p,D as c}from"./constants-80532729.js";import{s as d,A as m,x as f,l as u}from"./icon-6e78539e.js";import"./pageable-832f4cce.js";import"./index-5de34d6c.js";import"./contextualSignupPrompt-e2b45125.js";import"./faceplate-text-input-7ffdbd7f.js";import"./live-978a02ee.js";import"./text-input-e49faaea.js";import"./form-common-utils-3a6d5fab.js";import"./constants-95a2ecae.js";import"./faceplate-input-35f305aa.js";import"./input-element-c3273c12.js";import"./light-dom-slot-controller-0b9fcecb.js";import"./auth-flow-controller-e3a64832.js";import"./reload-to-logged-in-901008b9.js";import"./index-65f85776.js";import"./load-lazy-script-with-nonce-91b572d7.js";import"./with-recaptcha-865d1f58.js";import"./onboarding-2cb2ba8f.js";import"./shreddit-overlay-e6f4eb12.js";let b=l,g=window.location,j=class extends d{constructor(){super(...arguments),this.stepName=null,this.isStandalonePage=!1,this.open=!1,this.history=[],this.events=new o(this),this.scrollBlocker=new h(this),this.findStepElement=t=>this.querySelector(`[slot="${t}"]`),this.requestClose=()=>{this.blocking?this.isStandalonePage&&this.redirectToHome():this.close()},this.redirectToHome=()=>{g.href=location.origin},this.handleEscKey=this.events.define("keydown",(t=>{"Escape"!==t.key||this.blocking||this.close()})),this.onShredditSlot=this.events.define("shreddit-slotter-set-slot-name",(t=>{!t.defaultPrevented&&this.hasStep(t.detail.slotName)&&(t.preventDefault(),this.show(t.detail.slotName))})),this.handleDismissOverlay=this.events.define("dismiss-overlay",this.requestClose),this.handleAccountManagerDismissed=this.events.define("accountmanager-dismissed",this.requestClose),this.deprecated__onFaceplateTrack=this.events.define("faceplate-track",(t=>{const{source:e,action:s,noun:i}=t.detail;e===p&&s===c&&a.has(i)&&this.requestClose()}))}get blocking(){if(this.isStandalonePage)return!0;if(this.open&&this.stepName){return!!this.findStepElement(this.stepName)?.getAttribute("blocking")}return!1}connectedCallback(){super.connectedCallback(),null!==this.stepName&&this.show(this.stepName)}hasStep(t){return!!this.findStepElement(t)}async show(t,e){const s=this.findStepElement(t),i=s?.getAttribute("feature-name");if(!s||!i)return!1;try{await b({root:s,name:i,renderMode:n.Contents,...e,queryParams:{...e?.queryParams,is_standalone:this.isStandalonePage}})}finally{this.open=!0,this.history.push(t),this.stepName=t,this.scrollBlocker.blockPageScrolling()}return!0}back(){if(!this.open)return;this.history.pop();const t=this.history.at(-1);if(!t)return this.requestClose();this.stepName=t}close(){this.open=!1,this.stepName=null,this.history=[],this.scrollBlocker.unblockPageScrolling()}render(){return this.open?f`\n <div class="z-[100] fixed">\n <div \n class="${u(this.isStandalonePage?void 0:"fixed top-0 right-0 bottom-0 left-0 bg-black opacity-50 backdrop-blur-sm")}" \n tabindex="-1" \n @click="${this.requestClose}" \n></div>\n <slot name="${this.stepName}"></slot>\n <slot></slot>\n </div>\n `:m}};j.styles=[t],e([s({attribute:"step-name",type:String,reflect:!0})],j.prototype,"stepName",void 0),e([s({attribute:"is-standalone",type:Boolean})],j.prototype,"isStandalonePage",void 0),e([i()],j.prototype,"open",void 0),j=e([r("auth-flow-manager")],j);
//# sourceMappingURL=auth-overlay-client-js-42ca5878.js.map
